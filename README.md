## EPP-Checker
アプリケーションへのリンク：
[Link to app](https://epp-checker-8eescw7o48eetqvhvrbsgk.streamlit.app/)

## アプリケーションの概要
　本アプリケーションは、ペンギンの子育て行動において発生するEPP（つがい外父性）の疑いがある親子に対し、生物学的父親を遺伝情報から特定するツールです。

　ペンギンは子育てを行うためにつがいを形成しますが、稀に母ペンギンがペア外のオスと交配し、子を産むことがあります。この現象はEPPと呼ばれ、自然界においては遺伝的多様性を高めるために発生すると考えられています。しかし、動物園や水族館のような飼育施設では、血統登録簿にて血縁関係を記録・管理しているため、EPPの有無を正確に把握し、発覚した場合には生物学的父親を特定することが求められます。

　EPPの存在を確認し、該当する父親個体を特定するためには遺伝子解析が不可欠です。EPPが発生した場合でも、母ペンギンとつがいを形成しているオスが子育てを支援します。このため、母ペンギン、子ペンギン、そしてペアを組むオスペンギンの遺伝情報から親子鑑定を行うことで、EPPの有無を確認できます。そして、EPPが確認された場合には、コロニー内の全オス個体が父親の候補となりますが、多量の遺伝情報を手作業で照合するのは現実的ではありません。そこで、本アプリケーションでは、EPPが疑われるつがいにおける母子の個体と、コロニー内の全オス個体の遺伝情報を自動で解析することで、生物学的父親を効率的に特定します。

　本アプリケーションに２つのメニューがあり、サイドバーから選択できます。

## 使用方法

### 1. 父親候補の特定
　このメニューでは、上記の通り、EPPの疑いがある母親と子の遺伝情報に対し、コロニー内すべてのオス個体の遺伝情報を照合し、解析することで遺伝的な父親を特定します。

#### 入力データの準備
　‘Download’ボタンより、テンプレートデータを取得できます。これは、’child’, ‘mother’, ‘father’という３つのシートからなるエクセルファイルです。テンプレートに従い、入力データを作成してください。’child’, ‘mother’シートにはEPPの疑いがある個体を、‘father’シートには実の父親である可能性があるオス個体の情報を記述してください。

##### 注意点
    - 子と母親は１対１で対応しているため、対応順に各シートに遺伝情報を記述してください。
    - ’child’と’mother’の個体数は同じにならなければなりません。（例えば、’child’シートの３番目の個体と’mother’シートの３番目の個体は、親子関係でなければなりません。）
    - ‘father’シートの個体数は、確認したいオスの個体数によって可変です。
    - 個体の名前は重複がなければ自由に決められます。
    - マーカー名については特に指定がありません。ただし、各シートで同じ順になるようにしてください。

#### パラメータの設定
 　サイドバーから各パラメータを設定してください。まず、使用するマーカーの数を設定してください。（テンプレートファイルでは14種のマーカーの情報があるため、デフォルトは14となっています。）次に、許容度を設定してください。この値により、何種類以上のマーカーが遺伝的に一致すれば親子と判定されるかが決まります。厳しい判定を行いたい場合、マーカー数と同じ値にすることをお勧めします。
    
#### データのアップロード
　作成したエクセルファイル形式のデータを、’Browse files’ボタンよりアップロードしてください。アップロードしたデータのプレビューが表示されます。
    
#### データの解析（親子鑑定の実施）
　データが正常にアップロードされた状態で‘Analyze’ボタンをクリックすると、解析が始まります。
    
#### 結果の確認
　各子の個体に対して、遺伝的に父親である可能性があるオス個体が表示されます。もし表示されない場合は、パラメータである許容度を少し低くして再度解析を行うことをお勧めします。また、’Download results’ボタンより結果をエクセルファイル形式でダウンロードできます。一致したマーカーの種類など、より詳細な解析結果を確認する際に利用してください。


### 母親候補の特定
　このメニューでは、とある子の個体に対し、遺伝的な母親を特定します。子育てはEPPの有無に関係なく両親のつがいが行います。これにより母親は特定できていることが多いですが、母親が不明であるときにこのメニューで確認することができます。また、この解析により母親が遺伝的に正しいかを確認できるため、併せて子の取り違いが発生していないかを確認することができます。

#### 入力データの準備
　‘Download’ボタンより、テンプレートデータを取得できます。これは、’child’, ‘mother’, という２つのシートからなるエクセルファイルです。テンプレートに従い、入力データを作成してください。’child’シートにはEPPの疑いがある個体を、‘mother’シートには実の母親である可能性があるメス個体の情報を記述してください。
    
##### 注意点
    - ‘mother’シートの個体数は、確認したいオスの個体数によって可変です。
    - 個体の名前は重複がなければ自由に決められます。
    - マーカー名については特に指定がありません。ただし、各シートで同じ順になるようにしてください。

#### パラメータの設定
　サイドバーから各パラメータを設定してください。まず、使用するマーカーの数を設定してください。（テンプレートファイルでは14種のマーカーの情報があるため、デフォルトは14となっています。）次に、許容度を設定してください。この値により、何種類以上のマーカーが遺伝的に一致すれば親子と判定されるかが決まります。厳しい判定を行いたい場合、マーカー数と同じ値にすることをお勧めします。
    
#### データのアップロード
　作成したエクセルファイル形式のデータを、’Browse files’ボタンよりアップロードしてください。アップロードしたデータのプレビューが表示されます。
    
#### データの解析（親子鑑定の実施
　データが正常にアップロードされた状態で‘Analyze’ボタンをクリックすると、解析が始まります。
    
#### 結果の確認
　各子の個体に対して、遺伝的に母親である可能性があるメス個体が表示されます。もし表示されない場合は、パラメータである許容度を少し低くして再度解析を行うことをお勧めします。また、’Download results’ボタンより結果をエクセルファイル形式でダウンロードできます。一致したマーカーの種類など、より詳細な解析結果を確認する際に利用してください。
 
　さらに、’Download new data’ボタンより、解析結果から作成したデータをダウンロードできます。これは、父親候補の特定における入力データの形式に合わせたエクセルファイル形式のデータとなっています。このデータに’father’シートを追加することで、すぐに父親候補の特定を行うことができます。
